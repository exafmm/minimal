add smoothing
test kernel.cxx with D=0 and no srand48
Compare energy drift